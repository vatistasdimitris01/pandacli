#!/usr/bin/env node

import { spawn } from "child_process"
import { fileURLToPath } from "url"
import { dirname, join } from "path"
import { cwd } from "process"

const __filename = fileURLToPath(import.meta.url)
const __dirname = dirname(__filename)

function run() {
  const args = ["web", ...process.argv.slice(2)]
  const target = join(__dirname, "..", "src", "index.ts")
  
  const proc = spawn("bun", [target, ...args], {
    stdio: "inherit",
    cwd: cwd(),
  })

  proc.on("error", (err) => {
    console.error(err.message)
    process.exit(1)
  })

  proc.on("close", (code) => {
    process.exit(code ?? 0)
  })
}

run()
